<p>task-page works!</p>

<!-- Button trigger modal -->
<button
  type="button"
  class="btn btn-primary"
  data-bs-toggle="modal"
  data-bs-target="#exampleModal"
>
  Add Task
</button>

<!-- (click)="addTaskClicked()" -->

<br /><br /><br /><br /><br /><br /><br />

<!-- Modal -->
<div
  class="modal fade"
  id="exampleModal"
  tabindex="-1"
  aria-labelledby="exampleModalLabel"
  aria-hidden="true"
>
  <!-- Add task form model -->

  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">ADD TASK</h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <p>add-task works!</p>

        <!-- Main form start here -->

        <form class="row gy-2 gx-3 align-items-center" #form="ngForm">
          <div class="col-auto">
            <label class="form-label" for="taskDateInput">Date</label>
            <input
              type="date"
              class="form-control"
              id="taskDateInput"
              name="date"
              [(ngModel)]="task.date"
              required
            />
          </div>
          <div class="col-auto">
            <label class="form-label" for="taskNameInput">Task Name</label>
            <input
              type="text"
              class="form-control"
              id="taskNameInput"
              placeholder="eg: 2 km walk"
              name="name"
              [(ngModel)]="task.name"
              required
            />
          </div>
          <div class="col-auto">
            <label class="form-label" for="taskDesInput"
              >Task Description</label
            >
            <textarea
              class="form-control"
              id="taskDesInput"
              placeholder="eg: 2 km walk area name"
              name="description"
              [(ngModel)]="task.description"
            ></textarea>
          </div>
          <div class="col-auto">
            <label for="inputState" class="form-label">Priority</label>
            <select
              id="inputState"
              class="form-select"
              required
              name="priority"
              [(ngModel)]="task.priority"
            >
              <option selected>low</option>
              <option>medium</option>
              <option>high</option>
            </select>
          </div>

          <div class="col-auto">
            <label for="taskGroup" class="form-label">Task Group</label>
            <select
              id="taskGroup"
              name="group"
              class="form-control"
              [(ngModel)]="task.group"
              required
              (change)="otherSelected($event)"
            >
              <option value="learning">Learning</option>
              <option value="gym">Gym</option>
              <option value="office work">Office Work</option>
              <option value="home work">Home Work</option>
              <option value="friends meet">Friends Meet</option>
              <option value="others">Others</option>
            </select>
          </div>

          @if (isOtherGroup) {
          <div class="col-auto">
            <label for="otherGroup" class="form-label">Other Group</label>
            <input
              type="text"
              id="otherGroup"
              name="otherGroup"
              class="form-control"
              [(ngModel)]="task.otherGroup"
              required
            />
          </div>
          }
        </form>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-success"
          data-bs-dismiss="modal"
          [disabled]="form.invalid"
          (click)="addTask()"
        >
          Add Task
        </button>
      </div>
    </div>
  </div>
</div>

<!-- end -->

<!-- To Display Task Start -->

@for (date of dateTaskKeys; track $index) {

<div class="row mb-3">
  <div class="col d-flex align-items-center">
    <h5 class="mb-0">{{ date }}</h5>
  </div>
  <div
    class="progress col"
    role="progressbar"
    aria-label="progress"
    aria-valuenow="25"
    aria-valuemin="0"
    aria-valuemax="100"
  >
    <div
      class="progress-bar"
      [style.width]="progressBarUpdate(groupedTasks[date])"
    ></div>
  </div>
</div>

<div class="row row-cols-1 row-cols-md-3 g-4">
  @for (dtasks of groupedTasks[date]; track dtasks.id) {

  <div class="col">
    <div class="card h-100">
      <div
        class="card-header justify-content-between d-flex text-break align-items-center"
      >
        {{ dtasks.group }}

        <!--  -->
        @if (dtasks.priority == "high") {
        <span class="badge text-bg-danger ms-2">High</span>
        } @else if (dtasks.priority == "medium") {
        <span class="badge text-bg-warning ms-2">Medium</span>
        }@else {
        <span class="badge text-bg-primary ms-2">Low</span>
        }
        <!--  -->
      </div>
      <div class="card-body text-break">
        <h5 class="card-title">
          <div class="justify-content-between">
            <input
              class="form-check-input me-1"
              type="checkbox"
              [checked]="dtasks.completed"
              (change)="completedOrNot(dtasks)"
              id="{{ dtasks.id }}Checkbox"
            />

            <label class="form-check-label" for="{{ dtasks.id }}Checkbox">
              {{ dtasks.name }}
            </label>
          </div>
        </h5>

        <p class="card-text">
          {{ dtasks.description }}
        </p>
        
      </div>
      <div class="card-footer">
        <div class="ms-auto text-end">
          <button class="btn btn-primary btn-sm me-2" data-bs-toggle="modal" data-bs-target="#staticBackdrop"  >Edit</button>
          <button class="btn btn-danger btn-sm">Delete</button>
        </div>
      </div>
    </div>
  </div>
  }
</div>
<br />
}

<!-- Task Display End -->

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>add-task works!</p>

        <!-- Main form start here -->

        <form class="row gy-2 gx-3 align-items-center" #form="ngForm">
          <div class="col-auto">
            <label class="form-label" for="taskDateInput">Date</label>
            <input
              type="date"
              class="form-control"
              id="taskDateInput"
              name="date"
              [(ngModel)]="task.date"
              required
            />
          </div>
          <div class="col-auto">
            <label class="form-label" for="taskNameInput">Task Name</label>
            <input
              type="text"
              class="form-control"
              id="taskNameInput"
              placeholder="eg: 2 km walk"
              name="name"
              [(ngModel)]="task.name"
              required
            />
          </div>
          <div class="col-auto">
            <label class="form-label" for="taskDesInput"
              >Task Description</label
            >
            <textarea
              class="form-control"
              id="taskDesInput"
              placeholder="eg: 2 km walk area name"
              name="description"
              [(ngModel)]="task.description"
            ></textarea>
          </div>
          <div class="col-auto">
            <label for="inputState" class="form-label">Priority</label>
            <select
              id="inputState"
              class="form-select"
              required
              name="priority"
              [(ngModel)]="task.priority"
            >
              <option selected>low</option>
              <option>medium</option>
              <option>high</option>
            </select>
          </div>

          <div class="col-auto">
            <label for="taskGroup" class="form-label">Task Group</label>
            <select
              id="taskGroup"
              name="group"
              class="form-control"
              [(ngModel)]="task.group"
              required
              (change)="otherSelected($event)"
            >
              <option value="learning">Learning</option>
              <option value="gym">Gym</option>
              <option value="office work">Office Work</option>
              <option value="home work">Home Work</option>
              <option value="friends meet">Friends Meet</option>
              <option value="others">Others</option>
            </select>
          </div>

          
        </form>


      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button
          type="button"
          class="btn btn-success"
          data-bs-dismiss="modal"
          [disabled]="form.invalid"
          (click)="addTask()"
        >
          Update
        </button>
      </div>
    </div>
  </div>
</div>

<br /><br /><br /><br />
